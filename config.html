<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>serch config</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Geneva, Verdana, sans-serif;
        }
        .page-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .section-container {
            margin-bottom: 20px;
            background-color: #fff;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #e2e2e2;
            width: 550px;
        }
        .section-container-nonvisible {
            margin-bottom: 20px;
            align-items: center;
            width: 500px;
        }
        .dropdown {
            width: 600px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            overflow: hidden;
            background-color: #f1f1f1;
        }
        .dropdown-title {
            background-color: #f1f1f1;
            padding: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dropdown-content {
            border-top: 1px solid #e2e2e2;
            display: none;
        }
        .dropdown-content.active {
            display: block;
        }
        .row {
            padding: 1px;
            margin: 5px;
            display: flex;
            justify-content: space-between;
        }
        .row input {
            width: 48%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .gap {
            width: 5px;
        }
        .row input.prefix-input {
            width: 20px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
        }
        .prefix-placeholder {
            width: 20px;
            padding: 5px;
            text-align: center;
            color: #888;
            font-size: 14px;
        }
        .row input.bang-input {
            width: 45%;
        }
        .row input.destination-input {
            width: 45%;
        }
        .add-button {
            width: 25px;
            height: 25px;
            background-color: #bbb;
            border: 1px solid #999;
            padding-bottom: 3px;
            color: white;
            border-radius: 3px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .add-button:hover {
            background-color: #45a049;
        }
        .add-button-container {
            width: 45%;
            display: flex;
            justify-content: flex-end;
        }
        .add-row {
            padding: 1px;
            margin: 5px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            height: 25px; /* Match the height of input rows */
        }
        .reset-button-container {
            display: flex;
            justify-content: left;
            margin-top: 10px;
        }
        #resetButton {
            padding: 8px 12px;
            background-color: #bbb;
            color: white;
            border: 1px solid #999;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        #resetButton:hover {
            background-color: #d32f2f;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            border: 1px solid #e2e2e2;
            border-radius: 10px;
            width: 400px;
            overflow: hidden;
        }

        .modal-header {
            background-color: #f1f1f1;
            padding: 10px 15px;
            border-bottom: 1px solid #e2e2e2;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 18px;
            color: #333;
        }

        .modal-body {
            padding: 15px;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            padding: 10px 15px;
            background-color: #fff;
            border-top: 1px solid #e2e2e2;
        }

        .modal-buttons button {
            padding: 8px 12px;
            border: 1px solid #999;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }

        #confirmReset {
            background-color: #d32f2f;
            color: white;
            border-color: #b71c1c;
        }

        #confirmReset:hover {
            background-color: #b71c1c;
        }

        #cancelReset {
            background-color: #bbb;
            color: white;
            border-color: #999;
        }

        #cancelReset:hover {
            background-color: #999;
        }
    </style>
</head>

<body>
    <div class="page-container">
    <div class="section-container-nonvisible">
        <h1 style="font-size: 30px; text-align: center; margin-bottom: 0px;">serch</h1>
        <p style="text-align: center; color: #999; margin-top: 0px;">search engine router control hub.</p>
    </div>
    <div class="section-container">
        <div class="dropdown" title="Bangs are shortcuts that can send you to a specific site's search page, bangs are removed from the beginning of your search query.">
            <div class="dropdown-title">my Bangs</div>
            <div class="dropdown-content" id="bangsContent">
                <!-- Bangs content will be dynamically populated -->
            </div>
        </div>
        <div class="dropdown" style="margin-bottom: 0px;" title="Patterns are regex's that will be matched against your search query.">
            <div class="dropdown-title">my Patterns</div>
            <div class="dropdown-content" id="patternsContent">
                <!-- Patterns content will be dynamically populated -->
            </div>
        </div>
        <div class="reset-button-container">
            <button id="resetButton">Reset to Default</button>
        </div>
    </div>
    <div class="section-container">
        <p style="margin-left: 20px; margin-right: 20px; text-align: left; color: #999; font-size: 14px;">serch is a tool which allows you to route your search queries to different search engines via Bangs and Patterns. serch allows you to specialize around specific classes of search queries, for example, you may want to search for videos on a specific site, or you may want to search for images on a specific site.</p>
    </div>

    <script>
        // Cookie handling functions
        function setCookie(name, value, days) {
            const expires = new Date(Date.now() + days * 864e5).toUTCString();
            document.cookie = name + '=' + encodeURIComponent(JSON.stringify(value)) + '; expires=' + expires + '; path=/';
        }

        function getCookie(name) {
            const value = document.cookie.split('; ').find(row => row.startsWith(name + '='));
            return value ? JSON.parse(decodeURIComponent(value.split('=')[1])) : null;
        }

        // Data structure
        let data = {
            prefix: '!',
            bangs: [
                { bang: 'p', destination: 'https://perplexity.ai/search?q=' },
                { bang: 'ddg', destination: 'https://duckduckgo.com/?q=' },
                { bang: 'w', destination: 'https://wikipedia.org/wiki/' },
                { bang: 'g', destination: 'https://google.com/search?q=' },
                { bang: 'b', destination: 'https://bing.com/search?q=' }
            ],
            patterns: [
                { pattern: '^(at what|what\'s|when\'s|where\'s|how to|how does|what does|when does|where does|if the|when the|where to|look up|find the|info on|search for|what is|where is|why does|tell me|write about|explain|who is|look for|identify the|difference between|if a|when a)\\s+', destination: 'https://www.perplexity.ai/search?q=' },
                { pattern: '^', destination: 'https://duckduckgo.com/?q=' }
            ]
        };

        // Load data from cookies
        function loadDataFromCookies() {
            const cookieData = getCookie('serchData');
            if (cookieData) {
                data = cookieData;
            }
            renderData();
        }

        // Save data to cookies
        function saveDataToCookies() {
            setCookie('serchData', data, 365); // Save for 1 year
        }

        // Render data to DOM
        function renderData() {
            const bangsContent = document.getElementById('bangsContent');
            const patternsContent = document.getElementById('patternsContent');

            bangsContent.innerHTML = '';
            patternsContent.innerHTML = '';

            // Render bangs
            data.bangs.forEach((bang, index) => {
                const row = document.createElement('div');
                row.className = 'row';
                row.innerHTML = `
                    ${index === 0 ? `<input type="text" class="prefix-input" maxlength="2" value="${data.prefix}" id="prefixInput">` : `<div class="prefix-placeholder">${data.prefix}</div>`}
                    <div class="gap"></div>
                    <input type="text" class="bang-input" placeholder="Bang" value="${bang.bang}">
                    <div class="gap"></div>
                    <input type="text" class="destination-input" placeholder="Destination URL" value="${bang.destination}">
                `;
                bangsContent.appendChild(row);
            });

            // Add "+" button for bangs
            const addBangRow = document.createElement('div');
            addBangRow.className = 'row add-row';
            addBangRow.innerHTML = `
                <div class="gap"></div>
                <div style="width: 45%;"></div>
                <div class="gap"></div>
                <div class="add-button-container">
                    <button class="add-button">+</button>
                </div>
            `;
            bangsContent.appendChild(addBangRow);

            // Render patterns
            data.patterns.forEach(pattern => {
                const row = document.createElement('div');
                row.className = 'row';
                row.innerHTML = `
                    <input type="text" placeholder="Pattern" value="${pattern.pattern}">
                    <div class="gap"></div>
                    <input type="text" placeholder="Destination URL" value="${pattern.destination}">
                `;
                patternsContent.appendChild(row);
            });

            // Add "+" button for patterns
            const addPatternRow = document.createElement('div');
            addPatternRow.className = 'row add-row';
            addPatternRow.innerHTML = `
                <div style="width: 48%;"></div>
                <div class="gap"></div>
                <div style="width: 48%; display: flex; justify-content: flex-end;">
                    <button class="add-button">+</button>
                </div>
            `;
            patternsContent.appendChild(addPatternRow);

            // Add event listeners
            addEventListeners();
        }

        // Add event listeners
        function addEventListeners() {
            const prefixInput = document.getElementById('prefixInput');
            const bangInputs = document.querySelectorAll('.bang-input');
            const destinationInputs = document.querySelectorAll('.destination-input');
            const patternInputs = document.querySelectorAll('#patternsContent input');

            prefixInput.addEventListener('input', function() {
                data.prefix = this.value;
                updatePrefixPlaceholders();
                saveDataToCookies();
            });

            bangInputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    data.bangs[index].bang = this.value;
                    saveDataToCookies();
                });
            });

            destinationInputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    data.bangs[index].destination = this.value;
                    saveDataToCookies();
                });
            });

            patternInputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    const isPattern = index % 2 === 0;
                    const patternIndex = Math.floor(index / 2);
                    if (isPattern) {
                        data.patterns[patternIndex].pattern = this.value;
                    } else {
                        data.patterns[patternIndex].destination = this.value;
                    }
                    saveDataToCookies();
                });
            });

            // Add new row buttons
            const addBangButton = document.querySelector('#bangsContent .add-button');
            const addPatternButton = document.querySelector('#patternsContent .add-button');

            addBangButton.addEventListener('click', () => {
                data.bangs.push({ bang: '', destination: '' });
                renderData();
                saveDataToCookies();
            });

            addPatternButton.addEventListener('click', () => {
                data.patterns.push({ pattern: '', destination: '' });
                renderData();
                saveDataToCookies();
            });
        }

        // Update prefix placeholders
        function updatePrefixPlaceholders() {
            const prefixPlaceholders = document.querySelectorAll('.prefix-placeholder');
            prefixPlaceholders.forEach(placeholder => {
                placeholder.textContent = data.prefix;
            });
        }

        // Default data
        const defaultData = {
            prefix: '!',
            bangs: [
                { bang: 'p', destination: 'https://perplexity.ai/search?q=' },
                { bang: 'ddg', destination: 'https://duckduckgo.com/?q=' },
                { bang: 'w', destination: 'https://wikipedia.org/wiki/' },
                { bang: 'g', destination: 'https://google.com/search?q=' },
                { bang: 'b', destination: 'https://bing.com/search?q=' }
            ],
            patterns: [
                { pattern: '^(at what|what\'s|when\'s|where\'s|how to|how does|what does|when does|where does|if the|when the|where to|look up|find the|info on|search for|what is|where is|why does|tell me|write about|explain|who is|look for|identify the|difference between|if a|when a)\\s+', destination: 'https://www.perplexity.ai/search?q=' },
                { pattern: '^', destination: 'https://duckduckgo.com/?q=' }
            ]
        };

        // Function to reset data to default
        function resetToDefault() {
            data = JSON.parse(JSON.stringify(defaultData)); // Deep copy
            saveDataToCookies();
            renderData();
        }

        // Function to show the warning modal
        function showWarningModal() {
            const modal = document.getElementById('warningModal');
            modal.classList.add('active');
        }

        // Function to hide the warning modal
        function hideWarningModal() {
            const modal = document.getElementById('warningModal');
            modal.classList.remove('active');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadDataFromCookies();

            document.querySelectorAll('.dropdown-title').forEach(title => {
                title.addEventListener('click', () => {
                    const dropdown = title.parentElement;
                    dropdown.classList.toggle('active');
                    const content = dropdown.querySelector('.dropdown-content');
                    content.classList.toggle('active');
                });
            });

            // Modify the reset button event listener
            document.getElementById('resetButton').addEventListener('click', showWarningModal);

            // Add event listeners for modal buttons
            document.getElementById('confirmReset').addEventListener('click', () => {
                resetToDefault();
                hideWarningModal();
            });

            document.getElementById('cancelReset').addEventListener('click', hideWarningModal);

            // Close the modal if clicking outside of it
            window.addEventListener('click', (event) => {
                if (event.target === document.getElementById('warningModal')) {
                    hideWarningModal();
                }
            });
        });
    </script>

    <!-- Add this HTML for the modal just before the closing </body> tag -->
    <div id="warningModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>config reset</h2>
            </div>
            <div class="modal-body">
                <p style="margin: 0px;">Are you sure you want to reset to default settings? This action cannot be undone.</p>
            </div>
            <div class="modal-buttons">
                <button id="confirmReset">Yes, Reset</button>
                <button id="cancelReset">Cancel</button>
            </div>
        </div>
    </div>
</body>
</html>
